{% extends 'core/base.html' %}
{% block title %}
Signup
{% endblock title %}
{% load static %}{% load i18n %}
{% block content %}
  
<br><br>

{% comment %} top part {% endcomment %}
    <div class="header my-5 p-6 bg-primary rounded-xl mx-5" style="box-shadow: 0 5px 10px rgba(0, 0, 0, 0.5);">
        <div class="header-container myContainer">
            <div class="title">
                <span>{{collab.title}}</span>
                
            </div>
            <div class="date-time">
                <div class="date"><span>{% trans "Dodano" %}: </span> <span>{{ collab.date }}</span></div>
                <div class="time"><span>{% trans "Pozostało" %}: </span> <span id="countdown-timer"></span></div>
            </div>
        </div>
    </div>


<!-- Main info -->
    <div class="about my-5 p-6 bg-primary rounded-xl mx-5 shadow" style="box-shadow: 0 5px 10px rgba(0, 0, 0, 0.5);">
        <div class="about-container myContainer">
            <div class="about-item">
                <div class="title">Title Name Here</div>
                <div class="description">
                    <div class="iconHolder">
                        {% if collab.wokal == True %}
                        <img class="icon" src="{% static 'images/icons/vocals' %}.png" alt=""/> 
                        {% endif %}
                        {% if collab.instrument == True %}
                        <img class="icon" src="{% static 'images/icons/guitar' %}.png" alt=""/> 
                        {% endif %}
                        </div>
                    <p>{{collab.desc}}</p>

                </div>
            </div>
            <div class="about-item">
                <iframe src="https://www.youtube.com/embed/X9ZBb-yBQng?si=MwF7_FH_pWU4gL3s" title="YouTube video player"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
        </div>
    </div>

<!-- download section -->
    <div id="dynamic" class="list-description mt-5 mb-4 p-6 bg-primary rounded-xl mx-5" style="box-shadow: 0 5px 10px rgba(0, 0, 0, 0.5);">
        <div class="description-container myContainer">
            <div class="description-item">
                <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Fuga iusto et harum veniam corrupti quasi
                    dolorum alias earum repudiandae, voluptates dolore. Perferendis perspiciatis aperiam aut atque nam
                    reprehenderit quam repudiandae?</p>
                    <p>{% trans "Ilosc przesłanych zgłoszeń" %}: {{ submission_count }}</p>
            </div>
            <div class="description-item">
                <div class="list-container">
                    <ul class="list">
                        <li><span>List One</span></li>
                        <li><span>List Two</span></li>
                        <li><span>List Three</span></li>
                    </ul>
                    <div class="py-4 mt-6 text-lg bg-teal-700 hover:bg-secondary rounded-xl">
                        <button onclick="showConfirmation()">{% trans "Pobierz" %}</button>
                    </div>
                </div>
            </div>
        </div>
    </div>



{% comment %} bottom buttons {% endcomment %}
    <div class="button-container rounded-xl w-full">
        {% if request.user.is_authenticated %}
<a href="{% url 'collabs:przeslij' collab.id %}">
<button class="tableButtons">
    Przeslij swoje nagranie/ przeslano?.</button></a>
 {% endif %}


        <button class="py-4 mt-6 text-lg bg-primary hover:bg-secondary rounded-xl"
                style="box-shadow: 0 5px 10px rgba(0, 0, 0, 0.5);">{% trans "Zagłosuj" %}</button>
    </div>


     {% comment %} timer {% endcomment %}
<script>
var timeRemaining = {{ time }};

function updateCountdownTimer() {
    var days = Math.floor(timeRemaining / (3600 * 24));
    var hours = Math.floor((timeRemaining % (3600 * 24)) / 3600);
    var minutes = Math.floor((timeRemaining % 3600) / 60);
    var seconds = Math.floor(timeRemaining % 60);

    document.getElementById('countdown-timer').textContent = days + "d " + hours + "h " + minutes + "m " + seconds + "s ";

    if (timeRemaining <= 0) {
        clearInterval(countdownTimer);
        document.getElementById('countdown-timer').textContent = "Submission closed";
    }
}
console.log("elo")
updateCountdownTimer();

var countdownTimer = setInterval(function() {
timeRemaining--;
    updateCountdownTimer();
}, 1000);
    </script>



    {% comment %} download warning {% endcomment %}
<script>
    var downloadUrl = "{% url 'collabs:download_pack' collab.id %}";
</script>
<script>

    var originalContent = null;

    function showConfirmation() {
        var content = document.getElementById('dynamic');
        originalContent = content.innerHTML; 
        var height = content.offsetHeight;  
        content.style.opacity = '0';
        setTimeout(function() {
            content.style.display = 'flex'; 
            content.style.justifyContent = 'center';  
            content.style.alignItems = 'center';  
            content.innerHTML = '<p>Upewnij sie, ze masz stabilne polaczenie poniewaz domyslnie mozesz pobrac kazdy sampel tylko raz!</p>' +
            '<button id="countdownButton" style="width: 168px; opacity: 0.65; transition: opacity 0.45s ease-in-out" disabled class="btn-primary">5</button>' +
            '<button onclick="goBack()" style="margin: 0px 5px 0px 5px" class="btn-primary">Powrot</button>';
            content.style.minHeight = height + 'px';  
            content.style.opacity = '1';
            content.classList.add('bg-secondary');

    
            var countdown = 5;
            var countdownButton = document.getElementById('countdownButton');
            var countdownInterval = setInterval(function() {
                countdown--;
                if (countdown >= 1) {
                    countdownButton.style.opacity = '0.65';
                    countdownButton.innerText = countdown;
                } else {
                  
                    clearInterval(countdownInterval);
                    countdownButton.innerText = 'Pobierz!';
                    countdownButton.style.opacity = 1; 
                    countdownButton.disabled = false;
                    countdownButton.onclick = function() {
                        window.location.href = downloadUrl;
                    };
                }
            }, 1000);
        }, 500);  
    }

    function goBack() {
        var content = document.getElementById('dynamic');
        content.style.opacity = '0';
        setTimeout(function() {
            content.style.display = 'block';  // restore the original display value
            content.innerHTML = originalContent;  // restore the original content of the div
            content.style.opacity = '1';
        }, 500);
    }

</script>


{% endblock content %}